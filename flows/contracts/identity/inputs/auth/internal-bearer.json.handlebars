{{! Auth strategy formatter for internal services }}
{
  "strategy": "internal",
  "isInternal": true,
  {{#with (contract 'source') as |source|}}
    {{! Validity: valid source key}}
    {{#if request.headers.authorization}}
      "isValid": {{{ json (boolean source)}}},
    {{else}}
      "isValid": null,
    {{/if}}

    {{! Authority: source is included in the authorization list}}
    {{#with (contract 'authorization') as |authorization|}}
      "isAuthorized": {{{ json (includes authorization source) }}},
    {{else}}
      "isAuthorized": false,
    {{/with}}

    {{! Artifacts: just the name of the source }}
    "artifacts": {
      "source": {{{ json source }}}
    }
  {{else}}
    "isValid": false,
    "isAuthorized": false,
    "artifacts": {
      "source": null
    }
  {{/with}}
}
