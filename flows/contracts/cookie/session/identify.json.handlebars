{{#with (contract 'actions' (sum @index -1)) as |identify|}}
  {{#if (and
  	(gte identify.response.statusCode 200)
		(lt identify.response.statusCode 400)
  )}}
    {{#if (or
       (hasActiveIncompleteApplication ../application.id ../applications)
       (hasActivePostSubmissionApplication ../application.id ../applications)
    )}}
      {
        "name": "session",
        "value": null
      }
    {{else}}
        {
          "name": "session",
          "value": {{{ json identify.results.session}}},
          "options": {
            "httpOnly": true,
            "secure": true,
            "path": "/",
            "sameSite": "strict",
            "domain": ".earnest.com"
          }
      }
    {{/if}}
  {{else}}
    {
      "name": "session",
      "value": null
    }
  {{/if}}
{{else}}
  null
{{/with}}