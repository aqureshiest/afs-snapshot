{{#with (contract 'actions' (sum @index -1)) as |addDetails|}}
    {{#if (ne ../request.body.values.email ../applications.[0].details.email) }}
      {{#if (or
        (hasActiveIncompleteApplication ../application.applicant.id ../applications)
        (hasActivePostSubmissionApplication ../application.applicant.id ../applications)
      )}}
        { "action": "send-cosigner-access-email"}
      {{else}}
        {
          "action": "send-cosigner-access-email",
          "client": "NeasClient",
          "method": "post",
          "uri": "/auth/identity/access-code/send",
          "body": {
            "applicationId": {{{json ../application.applicant.id}}},
            "emailId": {{{json ../request.body.values.email}}}
          }
        }
      {{/if}}
  {{else}}
    { "action": "send-cosigner-access-email" }
  {{/if}}
{{else}}
  { "action": "send-cosigner-access-email" }
{{/with}}
