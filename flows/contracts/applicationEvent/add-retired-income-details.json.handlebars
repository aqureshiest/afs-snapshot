{{#if request.params.id}}
  {
    "event": "addDetails",
    "payload": {
      "id": "{{request.params.id}}",
      {{#with request.body.values}}
      "details":
        {{#obj}} {{! make sure to flatten each element into a single line}}
          {{#if additionalAmount}}
            {"income": {{#list}}
              {{#if additionalAmount.[0]}}
                {"index": 0, "type": "{{additionalAmount.0.type}}", "amount": {{{formatDollarsToCents additionalAmount.0.value}}} }
              {{/if}}
              {{#if additionalAmount.[1]}}
                {"index": 1, "type": "{{additionalAmount.1.type}}", "amount": {{{formatDollarsToCents additionalAmount.1.value}}} }
              {{/if}}
              {{#if additionalAmount.[2]}}
                {"index": 2, "type": "{{additionalAmount.2.type}}", "amount": {{{formatDollarsToCents additionalAmount.2.value}}} }
              {{/if}}
              {{#if additionalAmount.[3]}}
                {"index": 3, "type": "{{additionalAmount.3.type}}", "amount": {{{formatDollarsToCents additionalAmount.3.value}}} }
              {{/if}}
              {{#if additionalAmount.[4]}}
                {"index": 4, "type": "{{additionalAmount.4.type}}", "amount": {{{formatDollarsToCents additionalAmount.4.value}}} }
              {{/if}}
            {{/list}}
            }
          {{/if}}
        {{/obj}}
    },
    {{/with}}
    "fields": "application { id }"
  }
{{else}}
  null
{{/if}}