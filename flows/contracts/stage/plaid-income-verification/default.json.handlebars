{{#if request.params.id}}
{
  "type": "view",
  "id": "{{request.params.id}}",
  "definition": {
    "type": "bankAccounts",
    "definition": {
      "progress": 90,
      "key": "bankAccounts",
      "header": {
        "copy": "Let's verify your income.",
        "subCopy": "Link the account(s) where your paycheck is deposited for accurate eligibility and rates assessment."
      },
      "list": {
          "type": "ul",
          "defaultIcon": {
              "type": "NucleusIcon",
              "name": "CheckmarkCircleFilledIcon"
          },
          "items": [
              {
                  "copy": "Speeds up loan approval by up to 3 days"
              },
              {
                  "copy": "Personal information secured with end-to-end encryption"
              }
          ]
      },
      "disclosure": "`{\"component\":\"ActionButton\",\"props\":{\"button\":{\"copy\":\"How does income verification work?\",\"action\":{\"type\":\"modal\",\"properties\":{\"type\":\"disclosure\",\"definition\":{\"copy\":\"## How does income verification work?\\n\\nEarnest verifies your income by analyzing your direct deposits from your employer. We'll use your income verification to calculate repayment eligibility.\\n\\nEarnest uses plaid as a trusted partner to connect your external accounts. Any bank account data provided is encrypted and follows our Privacy Policy.\"}}}},\"styleAsLink\":true}}`",
      "plaidOptions": {
        "linkToken": {{{ json (contract 'method' )}}},
        "exchangeUrl": "plaid/exchange/{{{request.params.id}}}",
        "onError": [
          {
            "codes": ["loan-accounts-error"],
            "action" :{
              "type": "toast",
              "definition": {
                "type": "error",
                "copy": "Please select Savings or Checking accounts.",
                "icon": "icon-error" 
              }
            }
          },
          {
            "codes": ["application-service-error"],
            "action":{
              "type": "toast",
              "definition": {
                "type": "error",
                "copy": "An error ocurred while saving this, please try again.",
                "icon": "icon-error" 
              }
            }
          }
        ]
      },
      "backAction": {{{ json (contract 'back-button') }}},
      "primaryAction": {
        "copy": "Move to review",
        "action": {
          "key": "landingViewed",
          "type": "request",
          "properties": {
            "manifest": "save-details/financials/{{{request.params.id}}}"
          },
          "onError": {
            "codes": ["application-service-error"],
            "action": {
              "type": "toast",
              "definition": {
                "type": "error",
                "copy": "An error ocurred while saving financial Accounts, please try again.",
                "icon": "icon-error" 
              }
            }
          }
        }
      },
      "financialAccounts":
      {{#list}}
        {{#each application.primary.details.financialAccounts}}
          {"index": {{{ number @index}}}, "name": "{{this.name}}", "account_last4": "{{this.account_last4}}", "type": "{{this.type}}", "selected": {{json this.selected}} }
        {{/each}}
      {{/list}}
    }
  }
}
{{else}}
{
  "statusCode": 401,
  "message": "Id param is required."
}
{{/if}}