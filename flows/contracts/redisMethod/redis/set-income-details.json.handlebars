{{noop (contract 'actions' (sum @index -1))}}
{{#with (contract 'auth') as |auth|}}
  {{#if auth.artifacts.userId}}
  {
    "redisMethod": "setUserState",
    "key": {{{ json auth.artifacts.userId}}},
    "value": 
      {{#if ../request.body.values}}
        {{#obj}}
          {{#if ../request.body.values.annualIncome}}
            {"annualIncome": {{../request.body.values.annualIncome}} }
          {{/if}}
          {{#if ../request.body.values.additionalAmount.[0]}}
            {"additionalAmount": {{../request.body.values.additionalAmount.[0].value}} }
          {{/if}}
        {{/obj}}
      {{/if}}
  }
  {{else}}
    null
  {{/if}}
{{else}}
  null
{{/with}}
